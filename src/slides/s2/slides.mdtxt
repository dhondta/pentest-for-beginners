## <!-- .element: class="slideshow-title" --> 5-steps Process : Scanning

<small>by [Alexandre D'Hondt](https://github.com/dhondta), 24/11/16</small>

----

--flowchart--

-----

## 1. Introduction

----

### Purpose

**Identify ports, services and vulnerabilities**

<br>

- <!-- .element: class="fragment" --> From this step, techniques are essentially **active** <br> <small>A usable passive technique is eavesdropping (but very likely to give non-exhaustive results)</small>
- <!-- .element: class="fragment" --> Can only test systems covered by the <font color='red'>approval</font>

----

### Methodology

<u>Input</u>: **List of IP**

1. <!-- .element: class="fragment" --> System **alive** ?
2. <!-- .element: class="fragment" --> **Port** scanning
3. <!-- .element: class="fragment" --> Target **interrogation**
4. <!-- .element: class="fragment" --> **Vulnerability** scanning

<!-- .element: class="fragment" --> <u>Output</u>: **List of open ports, services and vulnerabilities**

-----

## 2. Activities

----

### System liveness & Port scanning

Often done together (e.g. using *Nmap*)

<!-- .element: class="fragment" --> Common network services often run on [common ports](./files/common-ports.pdf)

<!-- .element: class="fragment" --> &rarr; Can give an indication of **target's function**

----

#### Note about transport protocols

| **<abbr title="Transmission Control Protocol">TCP</abbr>** | versus | **<abbr title="User Datagram Protocol">UDP</abbr>** |
|:---:|:---:|:---:|
| <!-- .element: class="fragment" --> <small>**Connection-oriented** <br> (cfr [3-way Handshake](./files/tcp-3way-handshake.png))</small> | | <!-- .element: class="fragment" --> <small>**Connectionless**</small> |
| <!-- .element: class="fragment" --> <small>**Reliable** transfer</small> | | <!-- .element: class="fragment" --> <small>**Unreliable** transfer</small> |
| <!-- .element: class="fragment" --> <small>**Reordering**</small> | | <!-- .element: class="fragment" --> <small>**No reordering**</small> |
| <!-- .element: class="fragment" --> <small>HTTP, HTTPs, FTP, SMTP, Telnet</small> | | <!-- .element: class="fragment" --> <small>DNS, DHCP, TFTP, SNMP, RIP, VoIP</small> |

<!-- .element: class="fragment" --> <small><u>Major difference</u>: With TCP, completing the 3-way handshake means that the port is effectively opened ; with UDP, it cannot be decided unless the service does answer !</small>

<!-- .element: class="fragment" --> &rarr; TCP scans more performant than UDP ones<br> &rarr; UDP scans can provide inaccurrate results

----

### Target interrogation & Vulnerability scanning

Vulnerabilities can be discovered :

* <!-- .element: class="fragment" --> By manually testing some common services on common ports
* <!-- .element: class="fragment" --> By running scripts against the target (e.g. with NSE)
* <!-- .element: class="fragment" --> By running a scanner

----

#### Using Vulnerability Scanners

Using scanners or scripts is very **loud**

- <!-- .element: class="box fragment" --> Before running a scanner against a target, ensure the client organization's IT staff is warned about the timeframe when the scanning is performed as it could raise alarms from the IDS.

<!-- .element: class="box-warn" --> 

----

#### **Severity**: a characteristic of vulnerabilities

Some vulnerabilities can be poorly rewarding

<!-- .element: class="fragment" --> while others could allow an attacker to take **full control** of the target system !

<div class="tooltip fragment" style="height: 100px;"><img src="/img/warn.png" class="remove-layout"><b>Vulnerability dependency</b>
    <span class="tooltiptext">However, vulnerabilities with low severity could lead to an access that allows to exploit a more severe vulnerability !</li>
    </span>
</div>

----

#### Pivoting

Not always possible to get into a network ;

<!-- .element: class="fragment" --> It could be necessary to own a **perimeter device** <br> (public-facing system), <br> <small>*e.g. a router, a firewall or a web server*</small>

<!-- .element: class="fragment" --> and then move to an internal system

----

### Information Storage

**Purpose of Scanning** = Technical data collection

Therefore, it is important to:

- <!-- .element: class="fragment" --> Digitally **centralize** data <br> <small>(useful for quick searches, ...)</small>
- <!-- .element: class="fragment" --> **Organize** data

-----

## 3. Techniques & Tools

----

### System Liveness

<div class="column-left">**Description**</div><div class="column-right">
Addresses targets liveness as not every IP found during the first step necessarily relates to a running system.
</div>

<div class="column-left">**Tools**</div><div class="column-right">`ping`, `fping`</div>

<div class="column-left">**Findings**</div><div class="column-right">Hosts up amongst the input list of IP</div>

<div class="column-left">**Labs**</div><div class="column-right">
[Ping Sweeps](../../labs/s2-network-scanning/index.html#ping-sweeps)
</div>

----

### Port Scanning

<div class="column-left">**Description**</div><div class="column-right">
Relates to scanning target systems for open ports, that is, running services.
</div>

<div class="column-left">**Tools**</div><div class="column-right">Nmap</div>

<div class="column-left">**Findings**</div><div class="column-right">List of open ports and running services</div>

<div class="column-left">**Labs**</div><div class="column-right">
[Nmap Scans](../../labs/s2-port-scanning/index.html#tcp-connect-scan) <br>
[Nmap Scripting Engine (NSE)](../../labs/s2-port-scanning/index.html#banner-script) <br>
[Nmap OS Fingerprinting](../../labs/s2-port-scanning/index.html#os-fingerprinting)
</div>

----

### Service Testing

<div class="column-left">**Description**</div><div class="column-right">
Concerns manual tests of remote services on common ports for spotting inherently vulnerable services.
</div>

<div class="column-left">**Tools**</div><div class="column-right">Terminal</div>

<div class="column-left">**Findings**</div><div class="column-right">Trivial accesses to remote services</div>

<div class="column-left">**Labs**</div><div class="column-right">
[Common Services](../../labs/s2-service-testing/index.html#telnet)
</div>

----

### Vulnerability Scanning

<div class="column-left">**Description**</div><div class="column-right">
Corresponds to finding known vulnerabilities against the running services, often realized using a vulnerability scanner.
</div>

<div class="column-left">**Tools**</div><div class="column-right">OpenVAS, Nessus</div>

<div class="column-left">**Findings**</div><div class="column-right">List of known vulnerabilities</div>

<div class="column-left">**Labs**</div><div class="column-right">
[OpenVAS Scans](../../labs/s2-vulnerability-scanning/index.html#full-and-fast-scan)
</div>

----

### War Dialing

<div class="column-left">**Description**</div><div class="column-right">
</div>

<div class="column-left">**Tools**</div><div class="column-right"></div>

<div class="column-left">**Findings**</div><div class="column-right"></div>

<div class="column-left">**Labs**</div><div class="column-right">
</div>

----

### Wireless Scanning

<div class="column-left">**Description**</div><div class="column-right">
</div>

<div class="column-left">**Tools**</div><div class="column-right"></div>

<div class="column-left">**Findings**</div><div class="column-right"></div>

<div class="column-left">**Labs**</div><div class="column-right">
</div>

-----

## 4. Quizz

----

---quizz---

-----

## References

<small>
- [[1](https://books.google.com/books?isbn=0124116418)] Patrick Engelbretson, *The Basics of Hacking and Penetration Testing: Ethical Hacking and Penetration Testing Made Easy*, 2nd Ed, 2013.
- [[2](https://www.sans.org/course/hacker-techniques-exploits-incident-handling)] SANS Institute, *SEC504: Hacker Tools, Techniques, Exploits and Incident Handling*.
- [[3](http://www.tcpipguide.com/free/t_TCPConnectionEstablishmentProcessTheThreeWayHandsh-3.htm)] *The TCP/IP Guide*, 2005.

</small>

