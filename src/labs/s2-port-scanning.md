!!! danger "Goals"
    1. Practice with Nmap
    2. Provide a list of open ports and their associated services

!!! reminder "Reminder about ports"
    - **Known ports**: 0-1023
    - **Registered ports**: 1024-49151
    - **Dynamic ports**: 49152-65535

!!! reminder "Runtime options"
    - **Packet Tracing**: view packets by pressing `p`
    - **Verbosity**: increase by pressing `v`, turn off by pressing `Shift+v`
    - **Progress/Status**: view a report by pressing `space`

---

### TCP Connect Scan

**Reference**: [Engelbretson, p61]

**Command**: `nmap -sT -p- -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sT -p- -Pn 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00013s latency).
        Not shown: 65505 closed ports
        PORT      STATE SERVICE
        21/tcp    open  ftp
        22/tcp    open  ssh
        23/tcp    open  telnet
        25/tcp    open  smtp
        53/tcp    open  domain
        80/tcp    open  http
        111/tcp   open  rpcbind
        139/tcp   open  netbios-ssn
        445/tcp   open  microsoft-ds
        512/tcp   open  exec
        513/tcp   open  login
        514/tcp   open  shell
        1099/tcp  open  rmiregistry
        1524/tcp  open  ingreslock
        2049/tcp  open  nfs
        2121/tcp  open  ccproxy-ftp
        3306/tcp  open  mysql
        3632/tcp  open  distccd
        5432/tcp  open  postgresql
        5900/tcp  open  vnc
        6000/tcp  open  X11
        6667/tcp  open  irc
        6697/tcp  open  unknown
        8009/tcp  open  ajp13
        8180/tcp  open  unknown
        8787/tcp  open  unknown
        35636/tcp open  unknown
        43342/tcp open  unknown
        45526/tcp open  unknown
        53459/tcp open  unknown

        Nmap done: 1 IP address (1 host up) scanned in 14.69 seconds

    .

        :::console
        root@kali:~# nmap -sT -p- -Pn 192.168.100.128

        Starting Nmap 7.31 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00022s latency).
        Not shown: 65505 closed ports
        PORT      STATE SERVICE
        21/tcp    open  ftp
        22/tcp    open  ssh
        23/tcp    open  telnet
        25/tcp    open  smtp
        53/tcp    open  domain
        80/tcp    open  http
        111/tcp   open  rpcbind
        139/tcp   open  netbios-ssn
        445/tcp   open  microsoft-ds
        512/tcp   open  exec
        513/tcp   open  login
        514/tcp   open  shell
        1099/tcp  open  rmiregistry
        1524/tcp  open  ingreslock
        2049/tcp  open  nfs
        2121/tcp  open  ccproxy-ftp
        3306/tcp  open  mysql
        3632/tcp  open  distccd
        5432/tcp  open  postgresql
        5900/tcp  open  vnc
        6000/tcp  open  X11
        6667/tcp  open  irc
        6697/tcp  open  ircs-u
        8009/tcp  open  ajp13
        8180/tcp  open  unknown
        8787/tcp  open  msgsrvr
        35453/tcp open  unknown
        51259/tcp open  unknown
        52887/tcp open  unknown
        60123/tcp open  unknown

        Nmap done: 1 IP address (1 host up) scanned in 14.59 seconds

> !!! note "Remarks"
>     Ports above 8787 are dynamic, as it can be noticed from the two provided outputs obtained from two distinct executions of Metasploitable.

**Command**: `nmap -sTV -p- -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sTV -p- -Pn 192.168.100.128

        Starting Nmap 7.31 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.0024s latency).
        Not shown: 65505 closed ports
        PORT      STATE SERVICE     VERSION
        21/tcp    open  ftp         vsftpd 2.3.4
        22/tcp    open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
        23/tcp    open  telnet      Linux telnetd
        25/tcp    open  smtp        Postfix smtpd
        53/tcp    open  domain      ISC BIND 9.4.2
        80/tcp    open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
        111/tcp   open  rpcbind     2 (RPC #100000)
        139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
        445/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
        512/tcp   open  exec        netkit-rsh rexecd
        513/tcp   open  login?
        514/tcp   open  shell       Netkit rshd
        1099/tcp  open  rmiregistry GNU Classpath grmiregistry
        1524/tcp  open  shell       Metasploitable root shell
        2049/tcp  open  nfs         2-4 (RPC #100003)
        2121/tcp  open  ftp         ProFTPD 1.3.1
        3306/tcp  open  mysql       MySQL 5.0.51a-3ubuntu5
        3632/tcp  open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
        5432/tcp  open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
        5900/tcp  open  vnc         VNC (protocol 3.3)
        6000/tcp  open  X11         (access denied)
        6667/tcp  open  irc         Unreal ircd (Admin email admin@Metasploitable.LAN)
        6697/tcp  open  irc         Unreal ircd
        8009/tcp  open  ajp13       Apache Jserv (Protocol v1.3)
        8180/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
        8787/tcp  open  drb         Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb)
        35100/tcp open  nlockmgr    1-4 (RPC #100021)
        38026/tcp open  status      1 (RPC #100024)
        50009/tcp open  mountd      1-3 (RPC #100005)
        52416/tcp open  unknown
        Service Info: Hosts:  metasploitable.localdomain, localhost, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

        Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
        Nmap done: 1 IP address (1 host up) scanned in 171.32 seconds

> !!! note "Remarks"
>     Adding `-V` allows to get service versions but is of course much slower.

---

### SYN Scan

**Reference**: [Engelbretson, p63]

**Command**: `nmap -sS -p- -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sS -p- -Pn 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.000066s latency).
        Not shown: 65505 closed ports
        PORT      STATE SERVICE
        21/tcp    open  ftp
        ...
        53459/tcp open  unknown
        MAC Address: 00:0C:29:##:##:## (VMware)

        Nmap done: 1 IP address (1 host up) scanned in 14.46 seconds

> !!! note "Remarks"
>     In this lab, the SYN Scan does not provide more results than the TCP Connect Scan.
>     No real difference in performance regarding TCP Connect Scan is observed while it should be faster. This is surely due to Nmap implementation and multi-threading concerns.

---

### UDP Scan

**Reference**: [Engelbretson, p64]

**Command**: `nmap -sUV -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sUV -Pn 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00057s latency).
        Not shown: 993 closed ports
        PORT     STATE         SERVICE     VERSION
        53/udp   open          domain      ISC BIND 9.4.2
        68/udp   open|filtered dhcpc
        69/udp   open|filtered tftp
        111/udp  open          rpcbind     2 (RPC #100000)
        137/udp  open          netbios-ns  Microsoft Windows XP netbios-ssn
        138/udp  open|filtered netbios-dgm
        2049/udp open          nfs         2-4 (RPC #100003)
        MAC Address: 00:0C:29:##:##:## (VMware)
        Service Info: Host: METASPLOITABLE; OS: Windows XP; CPE: cpe:/o:microsoft:windows_xp

        Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
        Nmap done: 1 IP address (1 host up) scanned in 1188.20 seconds

> !!! note "Remarks"
>     This type of scan is very slow.

---

### Xmas Scan

**Reference**: [Engelbretson, p67]

**Command**: `nmap -sX -p- -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sX -p- -Pn 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00052s latency).
        All 65535 scanned ports on 192.168.100.128 are closed (65505) or open|filtered (30)
        MAC Address: 00:0C:29:##:##:## (VMware)

        Nmap done: 1 IP address (1 host up) scanned in 19.17 seconds

> !!! note "Remarks"
>     This does not provide any relevant information.

---

### Null Scan

**Reference**: [Engelbretson, p68]

**Command**: `nmap -sN -p- -Pn 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -sN -p- -Pn 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00018s latency).
        All 65535 scanned ports on 192.168.100.128 are closed (65505) or open|filtered (30)
        MAC Address: 00:0C:29:##:##:## (VMware)

        Nmap done: 1 IP address (1 host up) scanned in 18.75 seconds

> !!! note "Remarks"
>     This does not provide any relevant information.

---

### OS Fingerprinting

**Reference**: [Engelbretson, p71]

**Command**: `nmap -O 192.168.100.128`

??? note "**Output**"

        :::console
        root@kali:~# nmap -O 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00050s latency).
        Not shown: 977 closed ports
        PORT     STATE SERVICE
        21/tcp   open  ftp
        ...
        8180/tcp open  unknown
        MAC Address: 00:0C:29:##:##:## (VMware)
        Device type: general purpose
        Running: Linux 2.6.X
        OS CPE: cpe:/o:linux:linux_kernel:2.6
        OS details: Linux 2.6.9 - 2.6.33
        Network Distance: 1 hop

        OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
        Nmap done: 1 IP address (1 host up) scanned in 14.94 seconds

---

### Nmap Scripting Engine (NSE)

**Reference**: [Engelbretson, p70]

**Command**: `nmap --script `*`script|category`*`banner 192.168.100.128`

??? note "**Output**"

    **Script**: Banner

        :::console
        root@kali:~# nmap --script banner 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00041s latency).
        Not shown: 977 closed ports
        PORT     STATE SERVICE
        21/tcp   open  ftp
        |_banner: 220 (vsFTPd 2.3.4)
        22/tcp   open  ssh
        |_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
        23/tcp   open  telnet
        25/tcp   open  smtp
        53/tcp   open  domain
        80/tcp   open  http
        111/tcp  open  rpcbind
        139/tcp  open  netbios-ssn
        445/tcp  open  microsoft-ds
        512/tcp  open  exec
        513/tcp  open  login
        514/tcp  open  shell
        1099/tcp open  rmiregistry
        1524/tcp open  ingreslock
        |_banner: root@metasploitable:/#
        2049/tcp open  nfs
        2121/tcp open  ccproxy-ftp
        3306/tcp open  mysql
        5432/tcp open  postgresql
        5900/tcp open  vnc
        |_banner: RFB 003.003
        6000/tcp open  X11
        6667/tcp open  irc
        | banner: :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostna
        |_me...
        8009/tcp open  ajp13
        8180/tcp open  unknown
        MAC Address: 00:0C:29:##:##:## (VMware)

        Nmap done: 1 IP address (1 host up) scanned in 28.67 seconds

    !!! note "Remarks"
        This provides some additional details about only a few of the reported services.

    **Category**: Vulnerability

        :::console
        root@kali:~# nmap --script vuln 192.168.100.128

        Starting Nmap 7.01 ( https://nmap.org ) at ####-##-## ##:## CET
        Nmap scan report for 192.168.100.128
        Host is up (0.00017s latency).
        Not shown: 977 closed ports
        PORT     STATE SERVICE
        21/tcp   open  ftp
        | ftp-vsftpd-backdoor: 
        |   VULNERABLE:
        |   vsFTPd version 2.3.4 backdoor
        |     State: VULNERABLE (Exploitable)
        |     IDs:  CVE:CVE-2011-2523  OSVDB:73573
        |       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
        |     Disclosure date: 2011-07-03
        |     Exploit results:
        |       Shell command: id
        |       Results: uid=0(root) gid=0(root)
        |     References:
        |       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
        |       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
        |       http://osvdb.org/73573
        |_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
        22/tcp   open  ssh
        23/tcp   open  telnet
        25/tcp   open  smtp
        | smtp-vuln-cve2010-4344: 
        |_  The SMTP server is not Exim: NOT VULNERABLE
        53/tcp   open  domain
        80/tcp   open  http
        |_http-cross-domain-policy: ERROR: Script execution failed (use -d to debug)
        | http-csrf: 
        | Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.100.128
        |   Found the following possible CSRF vulnerabilities: 
        |     
        |     Path: http://192.168.100.128/twiki/TWikiDocumentation.html
        |     Form id: 
        |     Form action: http://TWiki.org/cgi-bin/passwd/TWiki/WebHome
        |     
        |     Path: http://192.168.100.128/twiki/TWikiDocumentation.html
        |     Form id: 
        |     Form action: http://TWiki.org/cgi-bin/passwd/Main/WebHome
        |     
        |     Path: http://192.168.100.128/twiki/TWikiDocumentation.html
        |     Form id: 
        |     Form action: http://TWiki.org/cgi-bin/edit/TWiki/
        |     
        |     Path: http://192.168.100.128/twiki/TWikiDocumentation.html
        |     Form id: 
        |     Form action: http://TWiki.org/cgi-bin/view/TWiki/TWikiSkins
        |     
        |     Path: http://192.168.100.128/twiki/TWikiDocumentation.html
        |     Form id: 
        |_    Form action: http://TWiki.org/cgi-bin/manage/TWiki/ManagingWebs
        |_http-dombased-xss: Couldn't find any DOM based XSS.
        | http-enum: 
        |   /tikiwiki/: Tikiwiki
        |   /test/: Test page
        |   /phpinfo.php: Possible information file
        |   /phpMyAdmin/: phpMyAdmin
        |   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
        |   /icons/: Potentially interesting folder w/ directory listing
        |_  /index/: Potentially interesting folder
        | http-fileupload-exploiter: 
        |   
        |_    Couldn't find a file-type field.
        |_http-frontpage-login: false
        | http-sql-injection: 
        |   Possible sqli for queries:
        |     http://192.168.100.128/dav/?C=S%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=N%3bO%3dD%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=M%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=D%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=login%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=show%2dlog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=credits%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=password%2dgenerator%2ephp%27%20OR%20sqlspider&username=anonymous
        |     http://192.168.100.128/mutillidae/index.php?page=capture%2ddata%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=notes%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=pen%2dtest%2dtool%2dlookup%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=html5%2dstorage%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=captured%2ddata%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=text%2dfile%2dviewer%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=user%2dinfo%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=source%2dviewer%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=change%2dlog%2ehtm%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=view%2dsomeones%2dblog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=add%2dto%2dyour%2dblog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=text%2dfile%2dviewer%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=php%2derrors%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=framing%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=view%2dsomeones%2dblog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=credits%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?do=toggle%2dsecurity%27%20OR%20sqlspider&page=home%2ephp
        |     http://192.168.100.128/mutillidae/index.php?page=documentation%2fvulnerabilities%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=arbitrary%2dfile%2dinclusion%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=source%2dviewer%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=user%2dinfo%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=register%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=user%2dpoll%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=usage%2dinstructions%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=installation%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=secret%2dadministrative%2dpages%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=installation%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=text%2dfile%2dviewer%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=change%2dlog%2ehtm%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=html5%2dstorage%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=login%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=captured%2ddata%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=credits%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=browser%2dinfo%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?do=toggle%2dhints%27%20OR%20sqlspider&page=home%2ephp
        |     http://192.168.100.128/mutillidae/?page=show%2dlog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=site%2dfooter%2dxss%2ddiscussion%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=set%2dbackground%2dcolor%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=documentation%2fhow%2dto%2daccess%2dMutillidae%2dover%2dVirtual%2dBox%2dnetwork%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=capture%2ddata%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=user%2dinfo%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/?page=add%2dto%2dyour%2dblog%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=login%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/index.php?page=home%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/mutillidae/./index.php?page=dns%2dlookup%2ephp%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=N%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=M%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=S%3bO%3dD%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=D%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=S%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=N%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=M%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=D%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=S%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=N%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=D%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=M%3bO%3dD%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=D%3bO%3dD%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=S%3bO%3dA%27%20OR%20sqlspider
        |     http://192.168.100.128/dav/?C=N%3bO%3dA%27%20OR%20sqlspider
        |_    http://192.168.100.128/dav/?C=M%3bO%3dA%27%20OR%20sqlspider
        |_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
        |_http-trace: TRACE is enabled
        111/tcp  open  rpcbind
        139/tcp  open  netbios-ssn
        445/tcp  open  microsoft-ds
        512/tcp  open  exec
        513/tcp  open  login
        514/tcp  open  shell
        1099/tcp open  rmiregistry
        | rmi-vuln-classloader: 
        |   VULNERABLE:
        |   RMI registry default configuration remote code execution vulnerability
        |     State: VULNERABLE
        |       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code executeion.
        |       
        |     References:
        |_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb
        1524/tcp open  ingreslock
        2049/tcp open  nfs
        2121/tcp open  ccproxy-ftp
        3306/tcp open  mysql
        |_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)
        5432/tcp open  postgresql
        5900/tcp open  vnc
        6000/tcp open  X11
        6667/tcp open  irc
        |_irc-unrealircd-backdoor: Looks like trojaned version of unrealircd. See http://seclists.org/fulldisclosure/2010/Jun/277
        8009/tcp open  ajp13
        8180/tcp open  unknown
        |_http-cross-domain-policy: ERROR: Script execution failed (use -d to debug)
        | http-enum: 
        |   /admin/: Possible admin folder
        |   /admin/index.html: Possible admin folder
        |   /admin/login.html: Possible admin folder
        |   /admin/admin.html: Possible admin folder
        |   /admin/account.html: Possible admin folder
        |   /admin/admin_login.html: Possible admin folder
        |   /admin/home.html: Possible admin folder
        |   /admin/admin-login.html: Possible admin folder
        |   /admin/adminLogin.html: Possible admin folder
        |   /admin/controlpanel.html: Possible admin folder
        |   /admin/cp.html: Possible admin folder
        |   /admin/index.jsp: Possible admin folder
        |   /admin/login.jsp: Possible admin folder
        |   /admin/admin.jsp: Possible admin folder
        |   /admin/home.jsp: Possible admin folder
        |   /admin/controlpanel.jsp: Possible admin folder
        |   /admin/admin-login.jsp: Possible admin folder
        |   /admin/cp.jsp: Possible admin folder
        |   /admin/account.jsp: Possible admin folder
        |   /admin/admin_login.jsp: Possible admin folder
        |   /admin/adminLogin.jsp: Possible admin folder
        |   /manager/html/upload: Apache Tomcat (401 Unauthorized)
        |   /manager/html: Apache Tomcat (401 Unauthorized)
        |   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload
        |   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload
        |   /admin/jscript/upload.html: Lizard Cart/Remote File upload
        |_  /webdav/: Potentially interesting folder
        |_http-frontpage-login: false
        MAC Address: 00:0C:29:##:##:## (VMware)

        Host script results:
        | smb-vuln-cve2009-3103: 
        |   VULNERABLE:
        |   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)
        |     State: VULNERABLE
        |     IDs:  CVE:CVE-2009-3103
        |           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, 
        |           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a 
        |           denial of service (system crash) via an & (ampersand) character in a Process ID High header field in a NEGOTIATE 
        |           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, 
        |           aka "SMBv2 Negotiation Vulnerability." 
        |           
        |     Disclosure date: 2009-09-08
        |     References:
        |       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103
        |_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103
        |_smb-vuln-ms10-054: false
        |_smb-vuln-ms10-061: false

        Nmap done: 1 IP address (1 host up) scanned in 327.53 seconds

!!! reminder "Nmap Scripting Engine (NSE)"

    **Options**:

     * `--script-help=[SCRIPT|CATEGORY]`: Get full help on a specific script or category
     * `--script [SCRIPT|CATEGORY]`: Run a specified script or category (multiple values possible, comma-separated)
     * `--script-updatedb`: 
     * `--script-args`: 
     * `--script-args-file`: 

    **Categories**:

     * `auth`: Authentication credentials (or bypassing them), e.g. `x11-access` or `ftp-anon`
     * `broadcast`: Non-listed host discovery (use `newtargets` script argument to add discovered hosts to Nmap queue)
     * `default`: Default set of scripts like when using `-sC` or `-A` rather than `--script`
     * `discovery`: Discover more about the network (including Windows shares, system details via SNMP and more)
     * `dos`: For testing Denial of Service vulnerabilities
     * `exploit`: Vulnerability exploitation
     * `external`: For querying information from third-party external systems, e.g. `whois`
     * `fuzzer`: For sending server software unexpected or randomized fields in packets (slow and bandwidth intensive), e.g. `dns-fuzz`
     * `intrusive`: Scripts like in the `safe` category but with the risk of crashing the target system
     * `malware`: For testing whether the target is infected by malwares or backdoors, e.g. `smtp-strangeport`
     * `safe`: Scripts not designed to crash services, use large amounts of bandwidth or other resources, or exploit security holes
     * `version`: Extension to the version detection feature (only runs if `-sV` provided)
     * `vuln`: Scripts checking for specific vulnerabilities

---

!!! important "Findings"
    **Operating System**:

    - **Version**: Linux 2.6.9 - 2.6.33
    - **CPE**: `cpe:/o:linux:linux_kernel:2.6`

    **Open ports & services**:

    | PORT | STATE | SERVICE | VERSION | BANNER | 
    |:----:|:-----:|:-------:|:-------:|:------:| 
    | <font color="red">**21/tcp**</font> | <font color="red">**open**</font> | <font color="red">**ftp**</font> | <font color="red">**vsftpd 2.3.4**</font> | <font color="red">**220 (vsFTPd 2.3.4)**</font> |
    | <font color="red">**22/tcp**</font> | <font color="red">**open**</font> | <font color="red">**ssh**</font> | <font color="red">**OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)**</font> | <font color="red">**SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1**</font> |
    | <font color="red">**23/tcp**</font> | <font color="red">**open**</font> | <font color="red">**telnet**</font> | <font color="red">**Linux telnetd**</font> | |
    | 25/tcp | open | smtp | Postfix smtpd | | 
    | 53/tcp | open | domain | ISC BIND 9.4.2 | | 
    | 53/udp | open | domain | ISC BIND 9.4.2 | | 
    | 68/udp | open/filtered | dhcpc | | | 
    | <font color="red">**69/udp**</font> | <font color="red">**open/filtered**</font> | <font color="red">**tftp**</font> | | | 
    | <font color="orange">**80/tcp**</font> | <font color="orange">**open**</font> | <font color="orange">**http**</font> | <font color="orange">**Apache httpd 2.2.8 ((Ubuntu) DAV/2)**</font> | | 
    | <font color="red">**111/tcp**</font> | <font color="red">**open**</font> | <font color="red">**rpcbind**</font> | <font color="red">**2 (RPC #100000)**</font> | | 
    | 111/udp | open | rpcbind | 2 (RPC #100000) | | 
    | 137/udp | open | netbios-ns | Microsoft Windows XP netbios-ssn | | 
    | 138/udp | open/filtered | netbios-dgm | | | 
    | 139/tcp | open | netbios-ssn | Samba smbd 3.X - 4.X (workgroup: WORKGROUP) | | 
    | 445/tcp | open | netbios-ssn | Samba smbd 3.X - 4.X (workgroup: WORKGROUP) | | 
    | 512/tcp | open | exec | netkit-rsh rexecd | | 
    | <font color="red">**513/tcp**</font> | <font color="red">**open**</font> | <font color="red">**login?**</font> | | | 
    | <font color="red">**514/tcp**</font> | <font color="red">**open**</font> | <font color="red">**shell**</font> | <font color="red">**Netkit rshd**</font> | | 
    | <font color="orange">**1099/tcp**</font> | <font color="orange">**open**</font> | <font color="orange">**rmiregistry**</font> | <font color="orange">**GNU Classpath grmiregistry**</font> | | 
    | <font color="red">**1524/tcp**</font> | <font color="red">**open**</font> | <font color="red">**shell**</font> | <font color="red">**Metasploitable root shell**</font> | <font color="red">**root@metasploitable:/#**</font> |
    | 2049/tcp | open | nfs | 2-4 (RPC #100003) | | 
    | 2049/udp | open | nfs | 2-4 (RPC #100003) | | 
    | <font color="red">**2121/tcp**</font> | <font color="red">**open**</font> | <font color="red">**ftp**</font> | <font color="red">**ProFTPD 1.3.1**</font> | | 
    | 3306/tcp | open | mysql | MySQL 5.0.51a-3ubuntu5 | | 
    | <font color="orange">**3632/tcp**</font> | <font color="orange">**open**</font> | <font color="orange">**distccd**</font> | <font color="orange">**distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))**</font> | | 
    | <font color="orange">**5432/tcp**</font> | <font color="orange">**open**</font> | <font color="orange">**postgresql**</font> | <font color="orange">**PostgreSQL DB 8.3.0 - 8.3.7**</font> | | 
    | 5900/tcp | open | vnc | VNC (protocol 3.3) | RFB 003.003 |
    | 6000/tcp | open | X11 | (access denied) | | 
    | 6667/tcp | open | irc | Unreal ircd (Admin email admin@Metasploitable.LAN) | :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname... |
    | 6697/tcp | open | irc | Unreal ircd | | 
    | 8009/tcp | open | ajp13 | Apache Jserv (Protocol v1.3) | | 
    | 8180/tcp | open | http | Apache Tomcat/Coyote JSP engine 1.1 | | 
    | 8787/tcp | open | drb | Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb) | | 
    | >30000/tcp | open | unknown | | |
    | >30000/tcp | open | unknown | | |
    | >30000/tcp | open | unknown | | | 
    | >30000/tcp | open | unknown | | | 

    **Ports in bold and <font color="red">red</font> are trivially testable (see next Lab, [Service Testing](/labs/s2-service-testing/)).**
    **Ports in bold and <font color="orange">orange</font> are easilly exploitable (see Lab [Vulnerability Exploitation](/labs/s3-vulnerability-exploitation/)).**

