!!! danger "Goals"
    1. Try to connect to some common services using Linux native tools
    2. Provide a list of non-protected services and their credentials

---

### Telnet (23/tcp)

**Reference**: [Engelbretson, p71]

**Command**: `telnet 192.168.100.128`

**Inputs**:

 - `banner` to display the banner and ask for credentials
 - As mentioned in the banner, *`Login with msfadmin/msfadmin to get started`*

??? note "**Session**"

        :::console
        root@kali:~# telnet 192.168.100.128

        Trying 192.168.100.128...
        Connected to 192.168.100.128.
        Escape character is '^]'.
        banner
                        _                  _       _ _        _     _      ____  
         _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ 
        | '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
        | | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ 
        |_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                                    |_|                                          


        Warning: Never expose this VM to an untrusted network!

        Contact: msfdev[at]metasploit.com

        Login with msfadmin/msfadmin to get started


        metasploitable login: msfadmin
        Password: 
        Last login: ### ### ## ##:##:## ### on tty1
        Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

        The programs included with the Ubuntu system are free software;
        the exact distribution terms for each program are described in the
        individual files in /usr/share/doc/*/copyright.

        Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
        applicable law.

        To access official Ubuntu documentation, please visit:
        http://help.ubuntu.com/
        No mail.
        To run a command as administrator (user "root"), use "sudo <command>".
        See "man sudo_root" for details.

        msfadmin@metasploitable:~$ 

    !!! important "Credentials discovered !"
        For the remaining tests, we can use username/password `msfadmin`.

!!! note
    The above session shows that the login banner is improperly set as it discloses critical information (i.e. the credentials of a sudoer).
    Note that, of course, this is knowingly configured so for educational purpose on Metasploitable.

---

### FTP (21/tcp, 2121/tcp)

**Command**: `ftp 192.168.100.128` or `ftp -p 192.168.100.128 2121`

**Inputs**:

 - `msfadmin` as the `Name` (as found during the Telnet testing)
 - `msfadmin` as the `Password` (as found during the Telnet testing)
 - `ls` to list the current directory
 - `cd ..` to change to the parent directory
 - `ls` to list the current directory

??? note "**Session**"

    **vsftpd (21)**

        :::console
        root@kali:~# ftp 192.168.100.128
        Connected to 192.168.100.128.
        220 (vsFTPd 2.3.4)
        Name (192.168.100.128:root): msfadmin
        331 Please specify the password.
        Password:
        230 Login successful.
        Remote system type is UNIX.
        Using binary mode to transfer files.
        ftp> ls
        200 PORT command successful. Consider using PASV.
        150 Here comes the directory listing.
        drwxr-xr-x    6 1000     1000         4096 Apr 28  2010 vulnerable
        226 Directory send OK.
        ftp> cd ..
        250 Directory successfully changed.
        ftp> ls
        200 PORT command successful. Consider using PASV.
        150 Here comes the directory listing.
        drwxr-xr-x    2 0        65534        4096 Mar 17  2010 ftp
        drwxr-xr-x    7 1000     1000         4096 Nov 18 11:25 msfadmin
        drwxr-xr-x    2 1002     1002         4096 Apr 16  2010 service
        drwxr-xr-x    3 1001     1001         4096 May 07  2010 user
        226 Directory send OK.
        ftp> exit
        221 Goodbye.

    **ProFTPD (2121/tcp)**

        :::console
        root@morfaline:~# ftp -p 192.168.100.128 2121
        Connected to 192.168.100.128.
        220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.100.128]
        Name (192.168.100.128:root): msfadmin
        331 Password required for msfadmin
        Password:
        230 User msfadmin logged in
        Remote system type is UNIX.
        Using binary mode to transfer files.
        ftp> ls
        227 Entering Passive Mode (192,168,100,128,165,220).
        150 Opening ASCII mode data connection for file list
        drwxr-xr-x   6 msfadmin msfadmin     4096 Apr 28  2010 vulnerable
        226 Transfer complete
        ftp> cd ..
        250 CWD command successful
        ftp> ls
        227 Entering Passive Mode (192,168,100,128,154,145).
        150 Opening ASCII mode data connection for file list
        drwxr-xr-x   2 root     nogroup      4096 Mar 17  2010 ftp
        drwxr-xr-x   7 msfadmin msfadmin     4096 Nov 18 11:25 msfadmin
        drwxr-xr-x   2 service  service      4096 Apr 16  2010 service
        drwxr-xr-x   3 user     user         4096 May  7  2010 user
        226 Transfer complete
        ftp> exit
        221 Goodbye.

!!! note
    Two FTP servers are running ; vsFTPd on port 21 and ProFTPD on port 2121.

---

### SSH (22/tcp)

**Command**: `ssh msfadmin@192.168.100.128`

**Inputs**:

 - `msfadmin` as the `password` (as found during the Telnet testing)
 - `sudo -i` to try to become superuser
 - `msfadmin` as the `password`

??? note "**Session**"

    **OpenSSH**

        :::console
        root@kali:~# ssh msfadmin@192.168.100.128
        msfadmin@192.168.100.128's password: 
        Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

        The programs included with the Ubuntu system are free software;
        the exact distribution terms for each program are described in the
        individual files in /usr/share/doc/*/copyright.

        Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
        applicable law.

        To access official Ubuntu documentation, please visit:
        http://help.ubuntu.com/
        No mail.
        Last login: ### ### ## ##:##:## ### ####
        msfadmin@metasploitable:~$ sudo -i
        [sudo] password for msfadmin: 
        root@metasploitable:~#

---

### TFTP (69/udp)

**Command**: `tftp 192.168.100.128`

**Inputs**:

 - `?` to get the list of available commands
 - `status` to get connection information

??? note "**Session**"

        :::console
        root@kali:~# tftp 192.168.100.128
        tftp> ?
        Commands may be abbreviated.  Commands are:

        connect 	connect to remote tftp
        mode    	set file transfer mode
        put     	send file
        get     	receive file
        quit    	exit tftp
        verbose 	toggle verbose mode
        trace   	toggle packet tracing
        status  	show current status
        binary  	set mode to octet
        ascii   	set mode to netascii
        rexmt   	set per-packet retransmission timeout
        timeout 	set total retransmission timeout
        ?       	print help information
        tftp> status
        Connected to 192.168.100.128.
        Mode: netascii Verbose: off Tracing: off
        Rexmt-interval: 5 seconds, Max-timeout: 25 seconds
        tftp>  

---

### RPC (111/tcp)

**Command**: `rpcclient -U "" 192.168.100.128` (null session)

**Inputs**:

 - just press enter at password prompt (null session)
 - `netshareenum` to list the available network shares
 - `srvinfo` to get some useful information about the server
 - `lookupnames root` to get the SID of the root user
 - `enumdomusers` to get the list of all user accounts

??? note "**Session**"

        :::console
        root@kali:~# rpcclient -U "" 192.168.100.128
        Enter 's password: 
        rpcclient $> netshareenum
        netname: tmp
	        remark:	oh noes!
	        path:	C:\tmp
	        password:	
        netname: opt
	        remark:	
	        path:	C:\tmp
	        password:	
        rpcclient $> srvinfo
	        METASPLOITABLE Wk Sv PrQ Unx NT SNT metasploitable server (Samba 3.0.20-Debian)
	        platform_id     :	500
	        os version      :	4.9
	        server type     :	0x9a03
        rpcclient $> lookupnames root
        root S-1-5-21-1042354039-2475377354-766472396-1000 (User: 1)
        rpcclient $> enumdomusers
        user:[games] rid:[0x3f2]
        user:[nobody] rid:[0x1f5]
        user:[bind] rid:[0x4ba]
        user:[proxy] rid:[0x402]
        user:[syslog] rid:[0x4b4]
        user:[user] rid:[0xbba]
        user:[www-data] rid:[0x42a]
        user:[root] rid:[0x3e8]
        user:[news] rid:[0x3fa]
        user:[postgres] rid:[0x4c0]
        user:[bin] rid:[0x3ec]
        user:[mail] rid:[0x3f8]
        user:[distccd] rid:[0x4c6]
        user:[proftpd] rid:[0x4ca]
        user:[dhcp] rid:[0x4b2]
        user:[daemon] rid:[0x3ea]
        user:[sshd] rid:[0x4b8]
        user:[man] rid:[0x3f4]
        user:[lp] rid:[0x3f6]
        user:[mysql] rid:[0x4c2]
        user:[gnats] rid:[0x43a]
        user:[libuuid] rid:[0x4b0]
        user:[backup] rid:[0x42c]
        user:[msfadmin] rid:[0xbb8]
        user:[telnetd] rid:[0x4c8]
        user:[sys] rid:[0x3ee]
        user:[klog] rid:[0x4b6]
        user:[postfix] rid:[0x4bc]
        user:[service] rid:[0xbbc]
        user:[list] rid:[0x434]
        user:[irc] rid:[0x436]
        user:[ftp] rid:[0x4be]
        user:[tomcat55] rid:[0x4c4]
        user:[sync] rid:[0x3f0]
        user:[uucp] rid:[0x3fc]
        rpcclient $> 

---

### Rlogin (513/tcp)

**Command**: `rlogin msfadmin@192.168.100.128`

**Inputs**:

 - `msfadmin` as the `password` (as found during the Telnet testing)
 - `sudo -i` to try to become superuser
 - `msfadmin` as the `password`

??? note "**Session**"

        :::console
        root@morfaline:~# rlogin msfadmin@192.168.100.128
        msfadmin@192.168.100.128's password: 
        Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

        The programs included with the Ubuntu system are free software;
        the exact distribution terms for each program are described in the
        individual files in /usr/share/doc/*/copyright.

        Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
        applicable law.

        To access official Ubuntu documentation, please visit:
        http://help.ubuntu.com/
        No mail.
        Last login: Tue Dec 13 10:11:28 2016
        msfadmin@metasploitable:~$ 

---

### Remote Shell (514/tcp)

**Command**: `rsh msfadmin@192.168.100.128`

**Inputs**:

 - `msfadmin` as the `password` (as found during the Telnet testing)
 - `sudo -i` to try to become superuser
 - `msfadmin` as the `password`

??? note "**Session**"

        :::console
        root@morfaline:~# rsh msfadmin@192.168.100.128
        msfadmin@192.168.100.128's password: 
        Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

        The programs included with the Ubuntu system are free software;
        the exact distribution terms for each program are described in the
        individual files in /usr/share/doc/*/copyright.

        Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
        applicable law.

        To access official Ubuntu documentation, please visit:
        http://help.ubuntu.com/
        No mail.
        Last login: ### ### ## ##:##:## ### ### from 192.168.100.129
        msfadmin@metasploitable:~$ sudo -i
        [sudo] password for msfadmin: 
        root@metasploitable:~# 

---

### Netcat (1524/tcp)

**Command**: `nc 192.168.100.128 1524`

**Input**: `dir` to list the current directory

??? note "**Session**"

        :::console
        root@kali:~# nc 192.168.100.128 1524
        root@metasploitable:/# dir
        bin    dev   initrd	 lost+found  nohup.out	root  sys  var
        boot   etc   initrd.img  media	     opt	sbin  tmp  vmlinuz
        cdrom  home  lib	 mnt	     proc	srv   usr
        root@metasploitable:/# 

!!! note
    This is a serious indication that the target is already owned !

---

!!! important "Findings"
    **Credentials**: username `msfadmin`, password `msfadmin`

    **Trivial vulnerabilities**:

     - **Telnet**: allows full control on the targeted system !
     - **FTP**: allows to retrieve any file on the targeted system !
     - **SSH**: allows full control on the targeted system !
     - **TFTP**: allows to retrieve any file on the targeted system !
     - **RPC**: provides useful information about network shares, server, ...
     - **Rlogin**: provides the same power as with SSH.
     - **Remote Shell**: provides the same power as with SSH.
     - **Netcat**: allows to connect to a remote root shell giving full power on the targeted system !
